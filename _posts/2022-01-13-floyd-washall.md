---
toc: true
title: "ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦[νμ΄μ¬ μμ  μ½”λ“]"
category:
  - Algorithm
---
ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦μ€ λ‹¤μµμ¤νΈλΌ, λ²¨λ§-ν¬λ“ μ•κ³ λ¦¬μ¦κ³Ό κ°™μ€ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ΄λ‹¤.

λ‹¨, λ‹¤μµμ¤νΈλΌμ™€ λ²¨λ§-ν¬λ“ μ•κ³ λ¦¬μ¦μ΄ **ν• μ§€μ μ—μ„ λ‹¤λ¥Έ νΉμ • μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅**λ¥Ό κµ¬ν•λ”λ° μ‚¬μ©λμ—λ‹¤λ©΄ ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦μ€ **λ¨λ“  μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ  κΉμ§€μ μµλ‹¨ κ²½λ΅**λ¥Ό λ¨λ‘ κµ¬ν•΄μ•Ό ν•λ” κ²½μ°μ— μ‚¬μ© κ°€λ¥ν•λ‹¤.

μ΄ μ™Έμ—λ„ λ‹¤λ¥Έ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦κ³Ό ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦μ μ°¨μ΄μ μ—λ” μ—¬λ¬κ°€μ§€κ°€ μλ‹¤.

λ‹¤μµμ¤νΈλΌμ κ²½μ° μµλ‹¨ κ±°λ¦¬λ¥Ό μ €μ¥ν•κΈ° μ„ν•΄ 1μ°¨μ› λ°°μ—΄μ„ μ‚¬μ©ν•μ€μ§€λ§ ν”λ΅μ΄λ“ μ›μ…μ κ²½μ° λ¨λ“  λ…Έλ“μ— λ€ν•μ—¬ λ‹¤λ¥Έ λ¨λ“  λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ±°λ¦¬ μ •λ³΄λ¥Ό μ €μ¥ν•΄μ•Ό ν•κΈ° λ•λ¬Έμ— **2μ°¨μ› λ°°μ—΄μ— μµλ‹¨ κ±°λ¦¬ μ •λ³΄λ¥Ό μ €μ¥**ν•λ‹¤.

λν• λ‹¤μµμ¤νΈλΌκ°€ κ·Έλ¦¬λ”” μ•κ³ λ¦¬μ¦μ΄μ—λκ²ƒμ— λ°ν•΄, ν”λ΅μ΄λ“ μ›μ…μ€ DPμ΄λ‹¤.

Nκ°μ λ…Έλ“κ°€ μ΅΄μ¬ν•  λ•, Nλ² λ§νΌ λ°λ³µν•μ—¬ μ ν™”μ‹μ— λ§κ² 2μ°¨μ› λ°°μ—΄μ„ κ°±μ‹ ν•λ‹¤.

## ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦ κ°λ…

ν”λ΅μ΄λ“ μ›μ…μ κΈ°λ³Έ κ°λ…μ€ λ‹¤μκ³Ό κ°™λ‹¤.

π‘‰Β      λ°”λ΅ μ΄λ™ν•λ” κ±°λ¦¬κ°€ νΉμ • λ…Έλ“λ¥Ό κ±°μ³μ„ μ΄λ™ν•λ” κ±°λ¦¬λ³΄λ‹¤ λ” λ§μ€ λΉ„μ©μ„ κ°€μ§„λ‹¤λ©΄ μ΄λ¥Ό λ” μ§§μ€ κ²ƒμΌλ΅ κ°±μ‹ ν•λ‹¤.

D<small>ab</small> = min$($D<small>ab</small>, D<small>ak</small> + D<small>kb</small>)

μ„ μ ν™”μ‹μ€ aμ—μ„ bλ΅ κ°€λ” μµμ†λΉ„μ©κ³Ό aμ—μ„ kλ¥Ό κ±°μ³ bλ΅ κ°€λ” λΉ„μ©μ„ λΉ„κµν•μ—¬ λ” μ‘μ€ κ°’μΌλ΅ κ°±μ‹ ν•λ‹¤.

Nκ°μ λ…Έλ“κ°€ μμ„λ•, aμ—μ„ bλ΅ 1 ~ Nκ°μ λ…Έλ“λ¥Ό κ±°μ³κ°€λ” λ¨λ“  κ²½μ°λ¥Ό κµ¬ν• λ‹¤μ κ±°μ³κ°€λ” λΉ„μ©κ³Ό λ°”λ΅ κ°€λ” λΉ„μ© μ¤‘ λ” μ‘μ€ κ°’μΌλ΅ μ—…λ°μ΄νΈ ν•λ‹¤.

## ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦ μν–‰κ³Όμ •

4κ°μ λ…Έλ“$($1 ~ 4)κ°€ μ΅΄μ¬ν•λ‹¤κ³  κ°€μ •ν•κ³  ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦μ μν–‰ κ³Όμ •μ„ μ‚΄ν΄λ³΄λ„λ΅ ν•κ² λ‹¤.

![Imgur](https://i.imgur.com/59atlx5.png)

λ¨Όμ € 1λ² λ…Έλ“λ¥Ό κ±°μ³ κ°€λ” κ²½μ°λ¥Ό κ³„μ‚°ν•΄ λ³΄κ² λ‹¤.

1λ² λ…Έλ“λ¥Ό μ μ™Έν• 2, 3, 4λ² λ…Έλ“μ—μ„ 2κ°μ λ…Έλ“λ¥Ό λ½‘λ” κ²½μ°λ¥Ό κ³ λ ¤ν•λ‹¤.

$($2, 3), $($2, 4), $($3, 2), $($3, 4), $($4, 2), $($4, 4)

λ¨Όμ € D23, $($2, 3)μ κ²½μ° , 2λ² λ…Έλ“μ—μ„ 3λ² λ…Έλ“λ΅ λ°”λ΅ κ°€λ” λΉ„μ©κ³Ό 2μ—μ„ 1λ² λ…Έλ“λ¥Ό κ±°μ³μ„ 3μΌλ΅ κ°€λ” λΉ„μ© μ¤‘, λ” μ‘μ€ κ°’μΌλ΅ Graph[2][3]κ°’μ„ κ°±μ‹ ν•λ‹¤.

D23 = min$($D23, D21 + D13)

λ‚λ¨Έμ§€ 5κ° κ°’λ„ 1λ² λ…Έλ“λ¥Ό κ±°μ³κ°€λ” κ²½μ°μ™€ λ°”λ΅κ°€λ” κ²½μ°λ¥Ό λΉ„κµν•μ—¬ λ” μ‘μ€ κ°’μΌλ΅ 2μ°¨μ› λ°°μ—΄ κ°’μ„ κ°±μ‹ ν•λ‹¤.

![Imgur](https://i.imgur.com/AxFkE5l.png)

λ§μ°¬κ°€μ§€λ΅ 2λ² λ…Έλ“λ¥Ό κ±°μ³κ°€λ” κ²½μ°λ¥Ό κ³„μ‚°ν•λ‹¤.

2λ² λ…Έλ“λ¥Ό μ μ™Έν• 1, 3, 4λ² λ…Έλ“μ—μ„ 2κ°μ λ…Έλ“λ¥Ό λ½‘λ” κ²½μ°λ¥Ό κ³ λ ¤ν•λ‹¤.

$($1, 3), $($1, 4), $($3, 1), $($3, 4), $($4, 1), $($4, 3)

D13μ κ²½μ° μ›λ λ¬΄ν•λ€μ κ°’μ„ κ°€μ΅κΈ° λ•λ¬Έμ— D12 + D23 = 11λ΅ κ°±μ‹ ν•λ‹¤.

3λ²λ…Έλ“λ¥Ό κ±°μ³κ°€λ” κ²½μ°, 4λ² λ…Έλ“λ¥Ό κ±°μ³κ°€λ” κ²½μ°λ„ κ°™μ€ λ°©μ‹μΌλ΅ μ§„ν–‰ν•μ—¬ 2μ°¨μ› λ°°μ—΄μ„ μ—…λ°μ΄νΈ ν•΄μ¤€λ‹¤.

λ…Έλ“μ κ°μλ§νΌ μ„μ κ³Όμ •μ„ λ°λ³µν•κ³  λ‚λ©΄ 2μ°¨μ› λ°°μ—΄μ—λ” λ¨λ“  λ…Έλ“μ—μ„ λ¨λ“  λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ±°λ¦¬ μ •λ³΄κ°€ μ €μ¥λλ‹¤.

**μµμΆ…κ²°κ³Ό**

![Imgur](https://i.imgur.com/yb1qR57.png)

μλ¥Ό λ“¤μ–΄ D14μ κ²½μ° 1λ² λ…Έλ“μ—μ„ 3λ² λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ±°λ¦¬κ°€ 6μ΄λΌλ” κ²ƒμ„ μ• μ μλ‹¤.

ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦ μ½”λ“ (Python)

```python
INF = int(1e9)

# λ…Έλ“μ κ°μ v, κ°„μ„ μ κ°μ e μ…λ ¥λ°›κΈ°
v, e = map(int, input().split())
# λ¨λ“  λ…Έλ“μ—μ„ λ¨λ“  λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ±°λ¦¬ μ €μ¥μ„ μ„ν• 2μ°¨μ› λ°°μ—΄ μƒμ„±
# μ΄κΈ°κ°’μ€ λ¬΄ν•λ€λ΅ μ΄κΈ°ν™”
G = [[INF] * (v + 1) for _ in range(v + 1)]

# μκΈ° μμ‹ μ—μ„ μκΈ° μμ‹ μΌλ΅ κ°€λ” λΉ„μ©μ€ 0μΌλ΅ μ΄κΈ°ν™”
for a in range(1, v + 1):
    for b in range(1, v + 1):
        if a == b:
            G[a][b] = 0

# κ° κ°„μ„ μ— λ€ν• μ •λ³΄ μ…λ ¥
for _ in range(e):
    # aμ—μ„ bλ΅ κ°€λ” λΉ„μ© c
    a, b, c = map(int, input().split())
    G[a][b] = min(G[a][b], c)
    
# μ ν™”μ‹μ— λ”°λΌ ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦ μν–‰ 
for k in range(1, v + 1):
    for a in range(1, v + 1):
        for b in range(1, v + 1):
            G[a][b] = min(G[a][b], G[a][k] + G[k][b])
            
# λ¨λ“  λ…Έλ“μ—μ„ λ¨λ“  λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ²½λ΅ μ¶λ ¥
for a in range(1, v + 1):
    for b in range(1, n + 1):
        # λ„λ‹¬ν•  μ μ—†λ” κ²½μ°, INFINITY μ¶λ ¥
        if G[a][b] == INF: print("INFINITY", end=" ")
        # λ„λ‹¬ν•  μ μλ” κ²½μ°, κ±°λ¦¬λ¥Ό μ¶λ ¥
        else: print(G[a][b], end=" ")
    print()
```

## **μ‹κ°„λ³µμ΅λ„**

μ•μ„ μ„¤λ…ν–λ“―μ΄ 2μ°¨μ› λ°°μ—΄μ— μµλ‹¨ κ±°λ¦¬ μ •λ³΄λ¥Ό μ €μ¥ν•λ‹¤.

ν„μ¬ ν™•μΈν•κ³  μλ” λ…Έλ“λ¥Ό μ μ™Έν•κ³ , N - 1κ°μ λ…Έλ“ μ¤‘μ—μ„ μ„λ΅ λ‹¤λ¥Έ λ…Έλ“ $($A, B)μμ„ μ„ νƒν•λ‹¤.

κ·Έ λ‹¤μ Aμ—μ„ 1λ²λ…Έλ“λ¥Ό κ±°μ³ Bλ΅ κ°€λ” κ²½λ΅κ°€ μ΅΄μ¬ν•λ‹¤λ©΄ A β†’ 1λ² λ…Έλ“ β†’ Bλ΅ κ°€λ” λΉ„μ©μ„ ν™•μΈν• λ‹¤μ μµλ‹¨ κ±°λ¦¬λ¥Ό κ°±μ‹ λ‹¨λ‹¤. λ•λ¬Έμ— O$($N<sup>2</sup>)μ‹κ°„μ΄ κ±Έλ¦¬κ³ , λ…Έλ“μ λ‹¨κ³„λ³„λ΅ Nλ² 2μ°¨μ› λ°°μ—΄μ„ μ²λ¦¬ν•΄μ•Ό ν•κΈ° λ•λ¬Έμ— **O$($N<sup>3</sup>)** μ μ‹κ°„μ΄ μ†μ”λλ‹¤.

μµλ‹¨ κ²½λ΅λ¥Ό μ°Ύμ•„μ•Ό ν•λ” λ¬Έμ λ¥Ό λ§μ£Όν• κ²½μ°, λ…Έλ“μ κ°μκ°€ λ§μ§€ μ•λ‹¤λ©΄ ν”λ΅μ΄λ“-μ™€μƒ¬ μ•κ³ λ¦¬μ¦μ„ μ μ©ν•΄λ„ μΆ‹λ‹¤. 

ν•μ§€λ§ λ…Έλ“μ™€ κ°„μ„ μ κ°μκ°€ λ§λ‹¤λ©΄, μ°μ„  μμ„νλ¥Ό μ΄μ©ν• λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•λ” νΈμ΄ μ λ¦¬ν•λ‹¤λ” κ²ƒμ„ μ£Όμν•μ.